<div class="edit-container">
    <div *ngIf="componentExists && satellite">
        <h1>Editing '{{ satellite.satelliteName }}' created by {{ username }}</h1>
    </div>
    <div *ngIf="!componentExists">
        <h1>Creating new satellite for {{ username }}</h1>
    </div>

    <!-- Edit form for satelliteimplemented model -->

    <form #satelliteEditForm="ngForm" name="form" (ngSubmit)="onSubmit()" novalidate>
        <!-- name -->
        <mat-form-field class="form-group" appearance="fill">
            <mat-label for="name">Name</mat-label>
            <input
                matInput
                type="text"
                name="username"
                class="form-control"
                [(ngModel)]="satellite!.satelliteName"
                #name="ngModel"
                minlength="1"
                required
                [ngClass]="{
                    'is-invalid': name.invalid && name.touched
                }"
            />
            <mat-error *ngIf="name.invalid && name.touched" class="invalid-feedback">
                <mat-error *ngIf="name.errors!['required']">Name is required</mat-error>
                <mat-error *ngIf="name.errors!['minlength']">Username must be at least 1 character long.</mat-error>
            </mat-error>
        </mat-form-field>

        <!-- purpose -->
        <mat-form-field class="form-group" appearance="fill">
            <mat-label for="purpose">Purpose</mat-label>
            <input
                matInput
                type="text"
                name="purpose"
                class="form-control"
                [(ngModel)]="satellite!.purpose"
                #purpose="ngModel"
                required
                [ngClass]="{
                    'is-invalid': purpose.invalid && purpose.touched
                }"
            />
            <mat-error *ngIf="purpose.invalid && purpose.touched" class="invalid-feedback">
                <mat-error *ngIf="purpose.errors!['required']">Purpose is required</mat-error>
            </mat-error>
        </mat-form-field>

        <div class="cols-3">
            <!-- mass -->
            <mat-form-field class="form-group mass" appearance="fill">
                <mat-label for="mass">Mass</mat-label>
                <input
                    matInput
                    type="text"
                    name="mass"
                    class="form-control"
                    [(ngModel)]="satellite!.mass"
                    #mass="ngModel"
                    required
                    min="1"
                    [ngClass]="{
                        'is-invalid': mass.invalid && mass.touched
                    }"
                />
                <mat-error *ngIf="mass.invalid && mass.touched" class="invalid-feedback">
                    <mat-error *ngIf="mass.errors!['required']">Mass is required</mat-error>
                    <mat-error *ngIf="mass.errors!['min']">Mass must be at least 1 kg.</mat-error>
                </mat-error>
            </mat-form-field>

            <!-- radiusOfBase -->
            <mat-form-field class="form-group radius" appearance="fill">
                <mat-label for="radiusB">Radius of base</mat-label>
                <input
                    matInput
                    type="text"
                    name="radiusB"
                    class="form-control"
                    [(ngModel)]="satellite!.sizeOfBase"
                    #radiusB="ngModel"
                    required
                    min="1"
                    [ngClass]="{
                        'is-invalid': radiusB.invalid && radiusB.touched
                    }"
                />
                <mat-error *ngIf="radiusB.invalid && radiusB.touched" class="invalid-feedback">
                    <mat-error *ngIf="radiusB.errors!['required']">Radius of base is required</mat-error>
                    <mat-error *ngIf="radiusB.errors!['min']">Radius of base must be at least 1 m.</mat-error>
                </mat-error>
            </mat-form-field>
        </div>

        <!-- colorOfBase -->
        <mat-form-field class="form-group color" appearance="fill">
            <mat-label for="colorB">Color of base</mat-label>
            <input
                matInput
                type="color"
                name="colorB"
                class="form-control"
                [(ngModel)]="satellite!.colorOfBase"
                #colorB="ngModel"
                (ngModelChange)="changeColorSatellite()"
                [ngClass]="{
                    'is-invalid': colorB.invalid && colorB.touched
                }"
            />
            <mat-error *ngIf="colorB.invalid && colorB.touched" class="invalid-feedback"> </mat-error>
        </mat-form-field>

        <div *ngIf="satellite.orbit">
            <!-- semi major axis -->
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="semimajoraxis">Semi major axis in km</mat-label>
                <input
                    matInput
                    type="number"
                    name="semimajoraxis"
                    class="form-control"
                    [(ngModel)]="semiMajorAxisWithoutEarthRadius"
                    #semiMajorAxis="ngModel"
                    (ngModelChange)="calculatePeriod()"
                    required
                    [min]="(minAltitude - orbitService.earthRadius).toString()"
                    [max]="orbitService.maxSMAEarth.toString()"
                    [ngClass]="{
                        'is-invalid': semiMajorAxis.invalid && semiMajorAxis.touched
                    }"
                />
                <mat-error *ngIf="semiMajorAxis.invalid && semiMajorAxis.touched" class="invalid-feedback">
                    <mat-error *ngIf="semiMajorAxis.errors!['required']">Semi major axis is required</mat-error>
                    <!-- <mat-error *ngIf="semiMajorAxis.errors!['min']">Orbit must be at least 1 m.</mat-error> -->
                </mat-error>
            </mat-form-field>
            <!-- period -->
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="period">Period in days</mat-label>
                <input
                    matInput
                    type="number"
                    name="period"
                    class="form-control"
                    [(ngModel)]="satellite!.orbit.period"
                    #period="ngModel"
                    (ngModelChange)="calculateSemiMajorAxis()"
                    required
                    [ngClass]="{
                        'is-invalid': period.invalid && period.touched
                    }"
                />
                <mat-error *ngIf="period.invalid && period.touched" class="invalid-feedback">
                    <mat-error *ngIf="period.errors!['required']">Semi major axis is required</mat-error>
                    <!-- <mat-error *ngIf="semiMajorAxis.errors!['min']">Orbit must be at least 1 m.</mat-error> -->
                </mat-error>
            </mat-form-field>
            <!-- inclination -->
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="inclination">Inclination</mat-label>
                <input
                    matInput
                    type="number"
                    name="inclination"
                    class="form-control"
                    [(ngModel)]="satellite!.orbit.inclination"
                    #inclination="ngModel"
                    (ngModelChange)="changeInclination()"
                    required
                    min="0"
                    max="180"
                    [ngClass]="{
                        'is-invalid': inclination.invalid && inclination.touched
                    }"
                />
                <mat-error *ngIf="inclination.invalid && inclination.touched" class="invalid-feedback">
                    <mat-error *ngIf="inclination.errors!['required']">Semi major axis is required</mat-error>
                    <!-- <mat-error *ngIf="semiMajorAxis.errors!['min']">Orbit must be at least 1 m.</mat-error> -->
                </mat-error>
            </mat-form-field>
            <!-- longitude (RA) -->
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="longitude">Longitude of ascending node</mat-label>
                <input
                    matInput
                    type="number"
                    name="longitude"
                    class="form-control"
                    [(ngModel)]="satellite!.orbit.longitudeOfAscendingNode"
                    #longitude="ngModel"
                    (ngModelChange)="changeAngle()"
                    required
                    min="0"
                    max="180"
                    [ngClass]="{
                        'is-invalid': longitude.invalid && longitude.touched
                    }"
                />
                <mat-error *ngIf="longitude.invalid && longitude.touched" class="invalid-feedback">
                    <mat-error *ngIf="longitude.errors!['required']">Semi major axis is required</mat-error>
                </mat-error>
            </mat-form-field>
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="perigee">Argument of perigee</mat-label>
                <input
                    matInput
                    type="number"
                    name="perigee"
                    class="form-control"
                    [(ngModel)]="satellite!.orbit.argumentOfPerigee"
                    #perigee="ngModel"
                    (ngModelChange)="changeAngle()"
                    required
                    min="0"
                    max="180"
                    [ngClass]="{
                        'is-invalid': perigee.invalid && perigee.touched
                    }"
                />
                <mat-error *ngIf="perigee.invalid && perigee.touched" class="invalid-feedback">
                    <mat-error *ngIf="perigee.errors!['required']">Semi major axis is required</mat-error>
                </mat-error>
            </mat-form-field>
            <!-- eccentricity -->
            <mat-form-field class="form-group orbit" appearance="fill">
                <mat-label for="eccentricity">Eccentricity</mat-label>
                <input
                    matInput
                    type="number"
                    name="eccentricity"
                    class="form-control"
                    [(ngModel)]="satellite!.orbit.eccentricity"
                    #eccentricity="ngModel"
                    (ngModelChange)="changeEccentricity()"
                    required
                    min="0"
                    max="1"
                    [ngClass]="{
                        'is-invalid': eccentricity.invalid && eccentricity.touched
                    }"
                />
                <mat-error *ngIf="eccentricity.invalid && eccentricity.touched" class="invalid-feedback">
                    <mat-error *ngIf="eccentricity.errors!['required']">Semi major axis is required</mat-error>
                    <!-- <mat-error *ngIf="semiMajorAxis.errors!['min']">Orbit must be at least 1 m.</mat-error> -->
                </mat-error>
            </mat-form-field>
        </div>
        <div id="scene-container"></div>

        <!-- Submit en Cancel buttons -->
        <div class="buttons">
            <div class="">
                <button
                    mat-flat-button
                    color="primary"
                    type="submit"
                    class="btn btn-primary"
                    [disabled]="!satelliteEditForm.valid"
                >
                    Submit
                </button>
                <button mat-flat-button class="btn btn-warning" (click)="backClicked()">Cancel</button>
            </div>
        </div>
    </form>
</div>
